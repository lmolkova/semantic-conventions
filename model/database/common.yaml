version: "2"
attribute_groups:
  - id: attributes.db.client.response
    visibility: internal
    attributes:
      - ref: db.response.status_code
        requirement_level:
          conditionally_required: If the operation failed and status code is available.
      - ref: error.type
        requirement_level:
          conditionally_required: If and only if the operation failed.
        note: >
          The `error.type` SHOULD match the `db.response.status_code` returned by the database or the client library,
          or the canonical name of exception that occurred.

          When using canonical exception type name, instrumentation SHOULD do the best effort to
          report the most relevant type. For example, if the original exception is wrapped into a
          generic one, the original exception SHOULD be preferred.

          Instrumentations SHOULD document how `error.type` is populated.

  - id: attributes.db.client.authority
    visibility: internal
    attributes:
      - ref: server.address
        brief: >
          Name of the database host.
      - ref: server.port
        requirement_level:
          conditionally_required: If using a port other than the default port for this DBMS and if `server.address` is set.

  - id: attributes.db.client.network
    visibility: internal
    attributes:
      - ref: network.peer.address
        brief: Peer address of the database node where the operation was performed.
        requirement_level:
          recommended: If applicable for this database system.
        note: >
          Semantic conventions for individual database systems SHOULD document whether `network.peer.*` attributes are applicable.
          Network peer address and port are useful when the application interacts with individual database nodes directly.

          If a database operation involved multiple network calls (for example retries), the address of the last contacted node SHOULD be used.
      - ref: network.peer.port
        requirement_level:
          recommended: If and only if `network.peer.address` is set.

  - id: attributes.db.client.query
    visibility: internal
    attributes:
      - ref: db.query.text
      - ref: db.query.summary
        requirement_level:
          recommended: if available through instrumentation hooks or if the instrumentation supports generating a query summary.

  - id: attributes.db.client.common
    visibility: internal
    include_groups:
      - attributes.db.client.query
      - attributes.db.client.response
      - attributes.db.client.authority
    attributes:
      - ref: db.operation.name
        requirement_level:
          conditionally_required: >
            If readily available and if there is a single operation name that describes the
            database call.
      - ref: db.collection.name
        requirement_level:
          conditionally_required: >
            If readily available and if a database call is performed on a single collection.
      - ref: db.namespace
        requirement_level:
          conditionally_required: If available.