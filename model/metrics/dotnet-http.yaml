groups:
  - id: metric.dotnet.dns.lookup.duration
    type: metric
    metric_name: dns.lookup.duration
    brief: Measures the time take to perform a DNS lookup.
    instrument: histogram
    unit: "s"
    note: Meter name is `System.Net.NameResolution`.
    attributes:
      - id: question.name
        type: string
        brief: The name being queried.
        requirement_level: required
        examples: ["www.example.com", "dot.net"]
        note: |
          The name being queried.

          If the name field contains non-printable
          characters (below 32 or above 126), those characters should be represented
          as escaped base 10 integers (\DDD). Back slashes and quotes should be escaped.
          Tabs, carriage returns, and line feeds should be converted to \t, \r, and
          \n respectively.

  - id: metric.dotnet.http.client.connections.usage
    type: metric
    metric_name: http.client.connections.usage
    brief: "Number of outbound HTTP connections that are currently active or idle on the client"
    instrument: updowncounter
    unit: "{connection}"
    note:
      Corresponding `EventCounter` names are `*-connections-current-total`; Meter name is `System.Net.Http`.
    attributes:
      - id: connection.state
        type:
          members:
            - id: active
              value: "active"
              brief: 'active state.'
            - id: idle
              value: "idle"
              brief: 'idle state.'
        brief: Connection state.
        requirement_level: required
        examples: ["active", "idle"]
      - ref: url.scheme
      - ref: network.protocol.version
      - ref: server.address
      - ref: server.socket.address
      - ref: server.port

  - id: metric.dotnet.http.client.connection.duration
    type: metric
    metric_name: http.client.connection.duration
    brief: "The duration of outbound HTTP connections."
    instrument: histogram
    unit: "s"
    note: Meter name is `System.Net.Http`.
    attributes:
      - ref: url.scheme
      - ref: network.protocol.version
      - ref: server.address
      - ref: server.socket.address
      - ref: server.port
      - ref: dotnet.error.code
      - ref: dotnet.http.request.error

  - id: metric.dotnet.http.client.duration
    type: metric
    metric_name: http.client.duration
    brief: "Measures the duration of outbound HTTP requests."
    instrument: histogram
    unit: "s"
    extends: metric_attributes.http.client
    attributes:
      - ref: dotnet.error.code
      - ref: dotnet.http.request.error
      - ref: server.address
        requirement_level: required
        brief: >
          Host identifier of the ["URI origin"](https://www.rfc-editor.org/rfc/rfc9110.html#name-uri-origin) HTTP request is sent to.
        note: |
          Determined by using the first of the following that applies

          - Host identifier of the [request target](https://www.rfc-editor.org/rfc/rfc9110.html#target.resource)
            if it's sent in absolute-form
          - Host identifier of the `Host` header

          SHOULD NOT be set if capturing it would require an extra DNS lookup.
      - ref: server.port
        requirement_level:
          conditionally_required: If not default (`80` for `http` scheme, `443` for `https`).
        brief: >
          Port identifier of the ["URI origin"](https://www.rfc-editor.org/rfc/rfc9110.html#name-uri-origin) HTTP request is sent to.
        note: >
          When [request target](https://www.rfc-editor.org/rfc/rfc9110.html#target.resource) is absolute URI, `server.port` MUST match
          URI port identifier, otherwise it MUST match `Host` header port identifier.

  - id: metric.dotnet.http.server.duration
    type: metric
    metric_name: http.server.duration
    brief: "Measures the duration of inbound HTTP requests."
    instrument: histogram
    unit: "s"
    extends: metric_attributes.http.server
    attributes:
      - ref: dotnet.error.code
      - ref: dotnet.http.request.error
      - ref: http.route
      - ref: url.scheme

  - id: metric.dotnet.http.client.active_requests
    type: metric
    metric_name: http.client.active_requests
    brief: "Number of outbound HTTP requests that have failed."
    instrument: updowncounter
    unit: "{request}"
    note: Corresponding `EventCounter` name is `current-requests`; Meter name is `System.Net.Http`.
    attributes:
      - ref: http.request.method
      - ref: url.scheme
      - ref: network.protocol.version
      - ref: server.address
      - ref: server.socket.address
      - ref: server.port

  - id: dotnet.http.client.request.time_in_queue
    type: metric
    metric_name: http.client.request.time_in_queue
    brief: "The amount of time requests spent on a queue waiting for an available connection."
    instrument: histogram
    unit: "s"
    note: Corresponding `EventCounter` name is `*-requests-queue-duration`; Meter name is `System.Net.Http`.
    attributes:
      - ref: http.request.method
      - ref: url.scheme
      - ref: network.protocol.version
      - ref: server.address
      - ref: server.socket.address
      - ref: server.port
